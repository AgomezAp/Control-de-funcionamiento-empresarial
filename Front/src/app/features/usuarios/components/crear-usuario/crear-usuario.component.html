<div class="crear-usuario-container">
  <div class="usuario-card">
    <!-- Header -->
    <div class="card-header">
      <h2 class="title">
        <i class="pi pi-user-plus"></i>
        <span>Crear Nuevo Usuario</span>
      </h2>
      <button class="btn-volver" (click)="volver()" type="button">
        <i class="pi pi-arrow-left"></i>
        <span>Volver</span>
      </button>
    </div>

    <!-- Formulario -->
    <form
      [formGroup]="usuarioForm"
      (ngSubmit)="onSubmit()"
      class="usuario-form"
    >
      <!-- Nombre Completo -->
      <div class="form-field">
        <label for="nombre" class="field-label">
          Nombre Completo <span class="required">*</span>
        </label>
        <input
          type="text"
          id="nombre"
          formControlName="nombre_completo"
          class="field-input"
          placeholder="Ingrese el nombre completo"
        />
        <small
          *ngIf="
            usuarioForm.get('nombre_completo')?.invalid &&
            usuarioForm.get('nombre_completo')?.touched
          "
          class="field-error"
        >
          El nombre es requerido (mínimo 3 caracteres)
        </small>
      </div>

      <!-- Correo Electrónico -->
      <div class="form-field">
        <label for="correo" class="field-label">
          Correo Electrónico <span class="required">*</span>
        </label>
        <input
          type="email"
          id="correo"
          formControlName="correo"
          class="field-input"
          placeholder="usuario@ejemplo.com"
        />
        <small
          *ngIf="
            usuarioForm.get('correo')?.invalid &&
            usuarioForm.get('correo')?.touched
          "
          class="field-error"
        >
          {{ getEmailError() }}
        </small>
      </div>

      <!-- Contraseña -->
      <div class="form-field">
        <label for="contrasena" class="field-label">
          Contraseña <span class="required">*</span>
        </label>
        <div class="password-wrapper">
          <input
            [type]="showPassword ? 'text' : 'password'"
            id="contrasena"
            formControlName="contrasena"
            class="field-input password-input"
            placeholder="Ingrese una contraseña segura"
          />
          <button
            type="button"
            class="password-toggle"
            (click)="togglePassword()"
          >
            <i [class]="showPassword ? 'pi pi-eye-slash' : 'pi pi-eye'"></i>
          </button>
        </div>
        <small
          *ngIf="
            usuarioForm.get('contrasena')?.invalid &&
            usuarioForm.get('contrasena')?.touched
          "
          class="field-error"
        >
          La contraseña debe tener al menos 6 caracteres
        </small>
      </div>

      <!-- Confirmar Contraseña -->
      <div class="form-field">
        <label for="confirmar" class="field-label">
          Confirmar Contraseña <span class="required">*</span>
        </label>
        <div class="password-wrapper">
          <input
            [type]="showConfirmPassword ? 'text' : 'password'"
            id="confirmar"
            formControlName="confirmar_contrasena"
            class="field-input password-input"
            placeholder="Confirme la contraseña"
          />
          <button
            type="button"
            class="password-toggle"
            (click)="toggleConfirmPassword()"
          >
            <i
              [class]="showConfirmPassword ? 'pi pi-eye-slash' : 'pi pi-eye'"
            ></i>
          </button>
        </div>
        <small
          *ngIf="
            usuarioForm.get('confirmar_contrasena')?.invalid &&
            usuarioForm.get('confirmar_contrasena')?.touched
          "
          class="field-error"
        >
          Las contraseñas no coinciden
        </small>
      </div>

      <!-- Rol -->
      <div class="form-field">
        <label for="rol" class="field-label">
          Rol <span class="required">*</span>
        </label>
        <div class="select-wrapper">
          <select id="rol" formControlName="rol_id" class="field-select">
            <option value="" disabled selected>Seleccione un rol</option>
            <option *ngFor="let rol of roles" [value]="rol.value">
              {{ rol.label }}
            </option>
          </select>
          <i class="pi pi-chevron-down select-icon"></i>
        </div>
        <small
          *ngIf="
            usuarioForm.get('rol_id')?.invalid &&
            usuarioForm.get('rol_id')?.touched
          "
          class="field-error"
        >
          El rol es requerido
        </small>
      </div>

      <!-- Área -->
      <div class="form-field">
        <label for="area" class="field-label">
          Área <span class="required">*</span>
        </label>
        <div class="select-wrapper">
          <select id="area" formControlName="area_id" class="field-select">
            <option value="" disabled selected>Seleccione un área</option>
            <option *ngFor="let area of areas" [value]="area.value">
              {{ area.label }}
            </option>
          </select>
          <i class="pi pi-chevron-down select-icon"></i>
        </div>
        <small
          *ngIf="
            usuarioForm.get('area_id')?.invalid &&
            usuarioForm.get('area_id')?.touched
          "
          class="field-error"
        >
          El área es requerida
        </small>
      </div>

      <!-- Botones -->
      <div class="form-actions">
        <button class="btn-cancelar" (click)="volver()" type="button">
          Cancelar
        </button>
        <button
          class="btn-guardar"
          [disabled]="usuarioForm.invalid || loading"
          type="submit"
        >
          <i class="pi pi-save" *ngIf="!loading"></i>
          <i class="pi pi-spin pi-spinner" *ngIf="loading"></i>
          <span>{{ loading ? "Guardando..." : "Crear Usuario" }}</span>
        </button>
      </div>
    </form>
  </div>
</div>
